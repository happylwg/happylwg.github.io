
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>线上排查 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-page-treeview/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="../jvm/jvm.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                        <b>1.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                        <b>1.2.</b>
                    
                    地址链接
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../address/link.html">
            
                <a href="../address/link.html">
            
                    
                        <b>1.2.1.</b>
                    
                    link
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../address/share.html">
            
                <a href="../address/share.html">
            
                    
                        <b>1.2.2.</b>
                    
                    共享
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                        <b>1.3.</b>
                    
                    课程
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../kecheng/java并发编程.html">
            
                <a href="../kecheng/java并发编程.html">
            
                    
                        <b>1.3.1.</b>
                    
                    java并发编程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../kecheng/从0开始学架构.html">
            
                <a href="../kecheng/从0开始学架构.html">
            
                    
                        <b>1.3.2.</b>
                    
                    从0开始学架构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../kecheng/搭建秒杀系统.html">
            
                <a href="../kecheng/搭建秒杀系统.html">
            
                    
                        <b>1.3.3.</b>
                    
                    搭建秒杀系统
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                        <b>1.4.</b>
                    
                    基础
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../base/binary.html">
            
                <a href="../base/binary.html">
            
                    
                        <b>1.4.1.</b>
                    
                    位运算
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../base/io.html">
            
                <a href="../base/io.html">
            
                    
                        <b>1.4.2.</b>
                    
                    io
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../base/JUC.html">
            
                <a href="../base/JUC.html">
            
                    
                        <b>1.4.3.</b>
                    
                    JUC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../base/mst.html">
            
                <a href="../base/mst.html">
            
                    
                        <b>1.4.4.</b>
                    
                    mst
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../base/算法.html">
            
                <a href="../base/算法.html">
            
                    
                        <b>1.4.5.</b>
                    
                    算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../base/领导力.html">
            
                <a href="../base/领导力.html">
            
                    
                        <b>1.4.6.</b>
                    
                    领导力
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../base/idea.html">
            
                <a href="../base/idea.html">
            
                    
                        <b>1.4.7.</b>
                    
                    idea
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.7.1" data-path="../base/template.html">
            
                <a href="../base/template.html">
            
                    
                        <b>1.4.7.1.</b>
                    
                    模版配置
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                        <b>1.5.</b>
                    
                    数据库
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../database/mysql.html">
            
                <a href="../database/mysql.html">
            
                    
                        <b>1.5.1.</b>
                    
                    mysql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../database/redis.html">
            
                <a href="../database/redis.html">
            
                    
                        <b>1.5.2.</b>
                    
                    redis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../base/事务.html">
            
                <a href="../base/事务.html">
            
                    
                        <b>1.5.3.</b>
                    
                    事务
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                        <b>1.6.</b>
                    
                    jvm
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../jvm/jvm.html">
            
                <a href="../jvm/jvm.html">
            
                    
                        <b>1.6.1.</b>
                    
                    内存优化汇总篇
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.2" data-path="线上排查汇总.html">
            
                <a href="线上排查汇总.html">
            
                    
                        <b>1.6.2.</b>
                    
                    线上排查
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                        <b>1.7.</b>
                    
                    spring
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../spring/spring-security.html">
            
                <a href="../spring/spring-security.html">
            
                    
                        <b>1.7.1.</b>
                    
                    spring-security
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >线上排查</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><ul><li><span class="title-icon "></span><a href="#&#x5207;&#x6362;&#x7528;&#x6237;"><b>1.6.2.1.1. </b>&#x5207;&#x6362;&#x7528;&#x6237;</a></li><li><span class="title-icon "></span><a href="#&#x78C1;&#x76D8;"><b>1.6.2.1.2. </b>&#x78C1;&#x76D8;</a></li><ul><li><span class="title-icon "></span><a href="#df"><b>1.6.2.1.2.1. </b>df</a></li></ul><li><span class="title-icon "></span><a href="#&#x7CFB;&#x7EDF;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;"><b>1.6.2.1.3. </b>&#x7CFB;&#x7EDF;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;</a></li><li><span class="title-icon "></span><a href="#cpu&#x8FC7;&#x9AD8;"><b>1.6.2.1.4. </b>cpu&#x8FC7;&#x9AD8;</a></li><li><span class="title-icon "></span><a href="#&#x5185;&#x5B58;&#x8FC7;&#x9AD8;"><b>1.6.2.1.5. </b>&#x5185;&#x5B58;&#x8FC7;&#x9AD8;</a></li><li><span class="title-icon "></span><a href="#1&#x3001;&#x5185;&#x5B58;&#x5FEB;&#x7167;pid&#x4E3A;&#x7EBF;&#x7A0B;id"><b>1.6.2.1.6. </b>1&#x3001;&#x5185;&#x5B58;&#x5FEB;&#x7167;,pid&#x4E3A;&#x7EBF;&#x7A0B;id</a></li><li><span class="title-icon "></span><a href="#2&#x3001;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;"><b>1.6.2.1.7. </b>2&#x3001;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;</a></li></ul><li><span class="title-icon "></span><a href="#3&#x3001;&#x5185;&#x5B58;oom&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x751F;&#x6210;dump&#x6587;&#x4EF6;&#xFF0C;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x914D;&#x7F6E;"><b>1.6.2.2. </b>3&#x3001;&#x5185;&#x5B58;OOM&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x751F;&#x6210;dump&#x6587;&#x4EF6;&#xFF0C;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x914D;&#x7F6E;</a></li><ul><li><span class="title-icon "></span><a href="#&#x538B;&#x7F29;&#x6587;&#x4EF6;-&#x6587;&#x4EF6;&#x540D;&#x3001;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;"><b>1.6.2.2.1. </b>&#x538B;&#x7F29;&#x6587;&#x4EF6; &#x6587;&#x4EF6;&#x540D;&#x3001;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;</a></li><li><span class="title-icon "></span><a href="#&#x89E3;&#x538B;"><b>1.6.2.2.2. </b>&#x89E3;&#x538B;</a></li><ul><li><span class="title-icon "></span><a href="#&#x4E8B;&#x7269;"><b>1.6.2.2.2.1. </b>&#x4E8B;&#x7269;</a></li><li><span class="title-icon "></span><a href="#innodb&#x591A;&#x79CD;&#x9501;"><b>1.6.2.2.2.2. </b>innodb&#x591A;&#x79CD;&#x9501;</a></li><li><span class="title-icon "></span><a href="#&#x6B7B;&#x9501;"><b>1.6.2.2.2.3. </b>&#x6B7B;&#x9501;</a></li></ul><li><span class="title-icon "></span><a href="#&#x6162;sql"><b>1.6.2.2.3. </b>&#x6162;sql</a></li><li><span class="title-icon "></span><a href="#&#x7F51;&#x7EDC;-&#x3001;ddos-&#x653B;&#x51FB;"><b>1.6.2.2.4. </b>&#x7F51;&#x7EDC; &#x3001;DDOS &#x653B;&#x51FB;</a></li><li><span class="title-icon "></span><a href="#&#x5B9E;&#x4F8B;&#x5047;&#x6B7B;&#x5206;&#x6790;"><b>1.6.2.2.5. </b>&#x5B9E;&#x4F8B;&#x5047;&#x6B7B;&#x5206;&#x6790;</a></li><li><span class="title-icon "></span><a href="#&#x5185;&#x5B58;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF1A;"><b>1.6.2.2.6. </b>&#x5185;&#x5B58;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF1A;</a></li><ul><li><span class="title-icon "></span><a href="#mat"><b>1.6.2.2.6.1. </b>MAT</a></li><li><span class="title-icon "></span><a href="#ibm-heapanalyzer"><b>1.6.2.2.6.2. </b>ibm-heapanalyzer</a></li><li><span class="title-icon "></span><a href="#arthas"><b>1.6.2.2.6.3. </b>Arthas</a></li></ul><li><span class="title-icon "></span><a href="#&#x5728;&#x7EBF;&#x5206;&#x6790;"><b>1.6.2.2.7. </b>&#x5728;&#x7EBF;&#x5206;&#x6790;</a></li><ul><li><span class="title-icon "></span><a href="#gc&#x65E5;&#x5FD7;"><b>1.6.2.2.7.1. </b>gc&#x65E5;&#x5FD7;</a></li><li><span class="title-icon "></span><a href="#&#x5806;&#x5FEB;&#x7167;&#x5206;&#x6790;"><b>1.6.2.2.7.2. </b>&#x5806;&#x5FEB;&#x7167;&#x5206;&#x6790;</a></li></ul></ul></ul></div><a href="#" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><div class="treeview__container"><ul>
<li> 
<ul>
<li><div><a href="#&#x5207;&#x6362;&#x7528;&#x6237;">&#x5207;&#x6362;&#x7528;&#x6237;</a><i></i></div></li>
<li><div><a href="#&#x78C1;&#x76D8;">&#x78C1;&#x76D8;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#df">df</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x7CFB;&#x7EDF;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;">&#x7CFB;&#x7EDF;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;</a><i></i></div></li>
<li><div><a href="#cpu&#x8FC7;&#x9AD8;">cpu&#x8FC7;&#x9AD8;</a><i></i></div></li>
<li><div><a href="#usage">@Usage</a><i></i></div></li>
<li><div><a href="#author-jerry-lee">@author Jerry Lee</a><i></i></div></li>
<li><div><a href="#&#x5185;&#x5B58;&#x8FC7;&#x9AD8;">&#x5185;&#x5B58;&#x8FC7;&#x9AD8;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#gc&#x7B97;&#x6CD5;">GC&#x7B97;&#x6CD5;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x65B0;&#x751F;&#x4EE3;&#x4F7F;&#x7528;gc&#x7B97;&#x6CD5;">&#x65B0;&#x751F;&#x4EE3;&#x4F7F;&#x7528;GC&#x7B97;&#x6CD5;</a><i></i></div></li>
<li><div><a href="#&#x8001;&#x5E74;&#x4EE3;&#x4F7F;&#x7528;gc&#x7B97;&#x6CD5;">&#x8001;&#x5E74;&#x4EE3;&#x4F7F;&#x7528;GC&#x7B97;&#x6CD5;</a><i></i></div></li>
<li><div><a href="#&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x603B;&#x7ED3;">&#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x603B;&#x7ED3;</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#mysql">mysql</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x5E38;&#x7528;&#x7CFB;&#x7EDF;&#x53D8;&#x91CF;&#x548C;&#x72B6;&#x6001;&#x53D8;&#x91CF;">&#x5E38;&#x7528;&#x7CFB;&#x7EDF;&#x53D8;&#x91CF;&#x548C;&#x72B6;&#x6001;&#x53D8;&#x91CF;</a><i></i></div></li>
</ul></li>
</ul></li>
<li><div><a href="#&#x67E5;&#x8BE2;&#x6162;sql&#x67E5;&#x8BE2;&#x662F;&#x5426;&#x5F00;&#x542F;">&#x67E5;&#x8BE2;&#x6162;SQL&#x67E5;&#x8BE2;&#x662F;&#x5426;&#x5F00;&#x542F;</a><i></i></div></li>
<li><div><a href="#&#x67E5;&#x8BE2;&#x6162;sql&#x7684;&#x65F6;&#x95F4;">&#x67E5;&#x8BE2;&#x6162;SQL&#x7684;&#x65F6;&#x95F4;</a><i></i></div></li>
<li><div><a href="#&#x67E5;&#x770B;&#x6162;sql&#x5B58;&#x653E;&#x8DEF;&#x5F84;&#xFF0C;&#x4E00;&#x822C;&#xFF1A;homemysqldata3016mysqlslowquerylog">&#x67E5;&#x770B;&#x6162;SQL&#x5B58;&#x653E;&#x8DEF;&#x5F84;&#xFF0C;&#x4E00;&#x822C;&#xFF1A;/home/mysql/data3016/mysql/slow_query.log</a><i></i></div></li>
<li><div><a href="#&#x67E5;&#x770B;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x7EA7;&#x522B;rdsread-committed---mysqlrepeatable-read">&#x67E5;&#x770B;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x7EA7;&#x522B;,RDS:READ-COMMITTED   Mysql:Repeatable read</a><i></i></div></li>
<li><div><a href="#&#x67E5;&#x770B;&#x6162;sql">&#x67E5;&#x770B;&#x6162;SQL</a><i></i></div></li>
<li><div><a href="#&#x67E5;&#x770B;autocommit&#x914D;&#x7F6E;">&#x67E5;&#x770B;autocommit&#x914D;&#x7F6E;</a><i></i></div></li>
<li><div><a href="#&#x540C;&#x4E0A;">&#x540C;&#x4E0A;</a><i></i></div></li>
<li><div><a href="#&#x8BBE;&#x7F6E;&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x7EA7;&#x522B;">&#x8BBE;&#x7F6E;&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x7EA7;&#x522B;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li> 
<ul>
<li><div><a href="#&#x4E8B;&#x7269;">&#x4E8B;&#x7269;</a><i></i></div></li>
<li><div><a href="#innodb&#x591A;&#x79CD;&#x9501;">innodb&#x591A;&#x79CD;&#x9501;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#&#x9501;&#x7C7B;&#x578B;">&#x9501;&#x7C7B;&#x578B;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x6B7B;&#x9501;">&#x6B7B;&#x9501;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x6162;sql">&#x6162;sql</a><i></i></div></li>
<li><div><a href="#&#x7F51;&#x7EDC;-&#x3001;ddos-&#x653B;&#x51FB;">&#x7F51;&#x7EDC; &#x3001;DDOS &#x653B;&#x51FB;</a><i></i></div></li>
<li><div><a href="#&#x5B9E;&#x4F8B;&#x5047;&#x6B7B;&#x5206;&#x6790;">&#x5B9E;&#x4F8B;&#x5047;&#x6B7B;&#x5206;&#x6790;</a><i></i></div></li>
<li><div><a href="#&#x5185;&#x5B58;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF1A;">&#x5185;&#x5B58;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF1A;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#mat">MAT</a><i></i></div></li>
<li><div><a href="#ibm-heapanalyzer">ibm-heapanalyzer</a><i></i></div></li>
<li><div><a href="#arthas">Arthas</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x5728;&#x7EBF;&#x5206;&#x6790;">&#x5728;&#x7EBF;&#x5206;&#x6790;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#gc&#x65E5;&#x5FD7;">gc&#x65E5;&#x5FD7;</a><i></i></div></li>
<li><div><a href="#&#x5806;&#x5FEB;&#x7167;&#x5206;&#x6790;">&#x5806;&#x5FEB;&#x7167;&#x5206;&#x6790;</a><i></i></div></li>
</ul></li>
</ul></li>
</ul>
</div>

<h2 id="&#x5207;&#x6362;&#x7528;&#x6237;"><a name="&#x5207;&#x6362;&#x7528;&#x6237;" class="anchor-navigation-ex-anchor" href="#&#x5207;&#x6362;&#x7528;&#x6237;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.1.1. &#x5207;&#x6362;&#x7528;&#x6237;</h2>
<p>&#x5207;&#x6362;app&#x7528;&#x6237;</p>
<p>sudo su - app</p>
<h2 id="&#x78C1;&#x76D8;"><a name="&#x78C1;&#x76D8;" class="anchor-navigation-ex-anchor" href="#&#x78C1;&#x76D8;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.1.2. &#x78C1;&#x76D8;</h2>
<p>java.io.IOException: &#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#x4E0D;&#x8DB3;</p>
<ul>
<li>&#x78C1;&#x76D8;&#x72B6;&#x6001;</li>
</ul>
<p>df -h</p>
<ul>
<li>du&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x5939;&#x5927;&#x5C0F;</li>
</ul>
<p>du -sh *</p>
<ul>
<li>&#x67E5;&#x770B;&#x6587;&#x4EF6;&#x5927;&#x5C0F;</li>
</ul>
<p>ls -lh</p>
<h3 id="df"><a name="df" class="anchor-navigation-ex-anchor" href="#df"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.1.2.1. df</h3>
<ul>
<li>-a &#x5217;&#x51FA;&#x6240;&#x6709;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</li>
<li>-h &#x4EE5;&#x4EBA;&#x7C7B;&#x523B;&#x5EA6;&#x6837;&#x5F0F;&#x6309;&#x7167;1024&#x8FDB;&#x5236;</li>
<li>-H &#x548C;-h&#x7C7B;&#x4F3C;&#xFF0C;&#x6309;1000&#x8FDB;&#x5236;</li>
</ul>
<table>
<thead>
<tr>
<th>&#x53C2;&#x6570;&#x540D;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>Filesystem</td>
<td>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;</td>
</tr>
<tr>
<td>size</td>
<td>&#x5BB9;&#x91CF;</td>
</tr>
<tr>
<td>Used</td>
<td>&#x4F7F;&#x7528;&#x91CF;</td>
</tr>
<tr>
<td>Avail</td>
<td>&#x53EF;&#x7528;&#x91CF;</td>
</tr>
<tr>
<td>use%</td>
<td>&#x4F7F;&#x7528;&#x7387;</td>
</tr>
<tr>
<td>Mounted on</td>
<td>&#x8DEF;&#x5F84;</td>
</tr>
</tbody>
</table>
<h2 id="&#x7CFB;&#x7EDF;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;"><a name="&#x7CFB;&#x7EDF;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;" class="anchor-navigation-ex-anchor" href="#&#x7CFB;&#x7EDF;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.1.3. &#x7CFB;&#x7EDF;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;</h2>
<ul>
<li>&#x547D;&#x4EE4;&#x67E5;&#x8BE2;&#x7CFB;&#x7EDF;&#x6700;&#x5927;&#x7528;&#x6237;&#x7EBF;&#x7A0B;&#x6570;&#xFF0C;max user processes</li>
</ul>
<p>ulimit -a</p>
<h2 id="cpu&#x8FC7;&#x9AD8;"><a name="cpu&#x8FC7;&#x9AD8;" class="anchor-navigation-ex-anchor" href="#cpu&#x8FC7;&#x9AD8;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.1.4. cpu&#x8FC7;&#x9AD8;</h2>
<p>top&#x67E5;&#x8BE2;cpu&#x4F7F;&#x7528;&#x7387;&#x6700;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;</p>
<p>&#x542F;&#x52A8;&#x53C2;&#x6570;</p>
<table>
<thead>
<tr>
<th>&#x53C2;&#x6570;&#x540D;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>-n</td>
<td>&#x6307;&#x5B9A;top&#x7ED3;&#x679C;&#x8F93;&#x51FA;&#x6B21;&#x6570;</td>
</tr>
<tr>
<td>-p</td>
<td>&#x8FDB;&#x7A0B;id</td>
</tr>
</tbody>
</table>
<p>&#x8FDB;&#x7A0B;&#x5185;&#x6307;&#x4EE4;</p>
<table>
<thead>
<tr>
<th>&#x53C2;&#x6570;&#x540D;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>H</td>
<td>&#x5DF2;&#x7EBF;&#x7A0B;&#x7EF4;&#x5EA6;&#x8FDB;&#x884C;&#x67E5;&#x770B;</td>
</tr>
<tr>
<td>N</td>
<td>&#x6309;&#x7167;pid&#x8FDB;&#x884C;&#x6392;&#x5E8F;</td>
</tr>
<tr>
<td>M</td>
<td>&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x7387;&#x6392;&#x5E8F;</td>
</tr>
<tr>
<td>P</td>
<td>&#x6309;&#x7167;cpu&#x4F7F;&#x7528;&#x7387;&#x6392;&#x5E8F;</td>
</tr>
</tbody>
</table>
<p>&#x7ED3;&#x679C;&#x53C2;&#x6570;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x53C2;&#x6570;&#x540D;</th>
<th>&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td>PID</td>
<td>&#x8FDB;&#x7A0B;id</td>
</tr>
<tr>
<td>USER</td>
<td>&#x8FDB;&#x7A0B;&#x6240;&#x6709;&#x8005;&#x7528;&#x6237;&#x59D3;&#x540D;</td>
</tr>
<tr>
<td>PR</td>
<td>&#x8FDB;&#x7A0B;&#x52A8;&#x6001;&#x4F18;&#x5148;&#x7EA7;</td>
</tr>
<tr>
<td>NI</td>
<td>&#x8FDB;&#x7A0B;&#x9759;&#x6001; &#x4F18;&#x5148;&#x7EA7;</td>
</tr>
<tr>
<td>VIRT</td>
<td>&#x4F7F;&#x7528;&#x865A;&#x62DF;&#x5185;&#x5B58;&#x6570;&#x91CF;</td>
</tr>
<tr>
<td>RES</td>
<td>&#x7269;&#x7406;&#x5185;&#x5B58;&#x6570;&#x91CF;</td>
</tr>
<tr>
<td>S</td>
<td>&#x8FDB;&#x7A0B;&#x72B6;&#x6001;&#x3001;D&#x4E0D;&#x53EF;&#x4E2D;&#x65AD;&#x7761;&#x7720;&#x72B6;&#x6001;R&#x8FD0;&#x884C;S&#x7761;&#x7720;T&#x8DDF;&#x8E2A;/&#x505C;&#x6B62; Z &#x50F5;&#x5C38;&#x8FDB;&#x7A0B;</td>
</tr>
<tr>
<td>%CPU</td>
<td>&#x4F7F;&#x7528;cpu&#x4F7F;&#x7528;&#x7387;</td>
</tr>
<tr>
<td>%MEM</td>
<td>&#x4F7F;&#x7528;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x7387;</td>
</tr>
<tr>
<td>TIME+</td>
<td>&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;cpu&#x7D2F;&#x8BA1;&#x65F6;&#x957F;</td>
</tr>
<tr>
<td>COMMAND</td>
<td>&#x542F;&#x52A8;&#x8FDB;&#x7A0B;&#x4F7F;&#x7528;&#x7684;&#x547D;&#x4EE4;&#x884C;</td>
</tr>
</tbody>
</table>
<p>&#x5229;&#x7528;top&#x67E5;&#x5230;&#x5360;&#x7528;cpu&#x6700;&#x9AD8;&#x7684;&#x8FDB;&#x7A0B;pid</p>
<p>1&#x3001;top -Hp pid //&#x6839;&#x636E;&#x8FDB;&#x7A0B;id&#x67E5;&#x627E;&#x6700;&#x9AD8;&#x7684;&#x7EBF;&#x7A0B;</p>
<p>2&#x3001;&#x9996;&#x5148;&#x5229;&#x7528; printf &quot;%x \n&quot; &#x5C06;tid&#x6362;&#x4E3A;&#x5341;&#x516D;&#x8FDB;&#x5236;&#xFF1A;xid &#x7EBF;&#x7A0B;id</p>
<p>3&#x3001; jstack -f 14 |grep nid=<em>*</em> -A 10</p>
<p>4&#x3001;&#x67E5;&#x770B;cpu&#x9AD8;&#x7684;&#x7EBF;&#x7A0B; &#x6587;&#x4EF6;&#x547D;&#x540D;jvm-busy-thread.sh</p>
<p>&#x6267;&#x884C;&#x65B9;&#x5F0F;&#xFF1A;./jvm-busy-thread.sh -p pid -c &apos;&#x68C0;&#x6D4B;&#x6B21;&#x6570;&#xFF0C;&#x9ED8;&#x8BA4;5&apos;</p>
<pre><code class="lang-shell">#!/bin/bash
# @Function
# Find out the highest cpu consumed threads of java, and print the stack of these threads.
#
# @Usage
#   $ ./show-busy-java-threads.sh
#
# @author Jerry Lee

readonly PROG=`basename $0`
readonly -a COMMAND_LINE=(&quot;$0&quot; &quot;$@&quot;)

usage() {
    cat &lt;&lt;EOF
Usage: ${PROG} [OPTION]...
Find out the highest cpu consumed threads of java, and print the stack of these threads.
Example: ${PROG} -c 10
Options:
    -p, --pid       find out the highest cpu consumed threads from the specifed java process,
                    default from all java process.
    -c, --count     set the thread count to show, default is 5
    -h, --help      display this help and exit
EOF
    exit $1
}

readonly ARGS=`getopt -n &quot;$PROG&quot; -a -o c:p:h -l count:,pid:,help -- &quot;$@&quot;`
[ $? -ne 0 ] &amp;&amp; usage 1
eval set -- &quot;${ARGS}&quot;

while true; do
    case &quot;$1&quot; in
    -c|--count)
        count=&quot;$2&quot;
        shift 2
        ;;
    -p|--pid)
        pid=&quot;$2&quot;
        shift 2
        ;;
    -h|--help)
        usage
        ;;
    --)
        shift
        break
        ;;
    esac
done
count=${count:-5}

redEcho() {
    [ -c /dev/stdout ] &amp;&amp; {
        # if stdout is console, turn on color output.
        echo -ne &quot;\033[1;31m&quot;
        echo -n &quot;$@&quot;
        echo -e &quot;\033[0m&quot;
    } || echo &quot;$@&quot;
}

yellowEcho() {
    [ -c /dev/stdout ] &amp;&amp; {
        # if stdout is console, turn on color output.
        echo -ne &quot;\033[1;33m&quot;
        echo -n &quot;$@&quot;
        echo -e &quot;\033[0m&quot;
    } || echo &quot;$@&quot;
}

blueEcho() {
    [ -c /dev/stdout ] &amp;&amp; {
        # if stdout is console, turn on color output.
        echo -ne &quot;\033[1;36m&quot;
        echo -n &quot;$@&quot;
        echo -e &quot;\033[0m&quot;
    } || echo &quot;$@&quot;
}

# Check the existence of jstack command!
if ! which jstack &amp;&gt; /dev/null; then
    [ -z &quot;$JAVA_HOME&quot; ] &amp;&amp; {
        redEcho &quot;Error: jstack not found on PATH!&quot;
        exit 1
    }
    ! [ -f &quot;$JAVA_HOME/bin/jstack&quot; ] &amp;&amp; {
        redEcho &quot;Error: jstack not found on PATH and $JAVA_HOME/bin/jstack file does NOT exists!&quot;
        exit 1
    }
    ! [ -x &quot;$JAVA_HOME/bin/jstack&quot; ] &amp;&amp; {
        redEcho &quot;Error: jstack not found on PATH and $JAVA_HOME/bin/jstack is NOT executalbe!&quot;
        exit 1
    }
    export PATH=&quot;$JAVA_HOME/bin:$PATH&quot;
fi

readonly uuid=`date +%s`_${RANDOM}_$$

cleanupWhenExit() {
    rm /tmp/${uuid}_* &amp;&gt; /dev/null
}
trap &quot;cleanupWhenExit&quot; EXIT

printStackOfThreads() {
    local line
    local count=1
    while IFS=&quot; &quot; read -a line ; do
        local pid=${line[0]}
        local threadId=${line[1]}
        local threadId0x=&quot;0x`printf %x ${threadId}`&quot;
        local user=${line[2]}
        local pcpu=${line[4]}

        local jstackFile=/tmp/${uuid}_${pid}

        [ ! -f &quot;${jstackFile}&quot; ] &amp;&amp; {
            {
                if [ &quot;${user}&quot; == &quot;${USER}&quot; ]; then
                    jstack ${pid} &gt; ${jstackFile}
                else
                    if [ $UID == 0 ]; then
                        sudo -u ${user} jstack ${pid} &gt; ${jstackFile}
                    else
                        redEcho &quot;[$((count++))] Fail to jstack Busy(${pcpu}%) thread(${threadId}/${threadId0x}) stack of java process(${pid}) under user(${user}).&quot;
                        redEcho &quot;User of java process($user) is not current user($USER), need sudo to run again:&quot;
                        yellowEcho &quot;    sudo ${COMMAND_LINE[@]}&quot;
                        echo
                        continue
                    fi
                fi
            } || {
                redEcho &quot;[$((count++))] Fail to jstack Busy(${pcpu}%) thread(${threadId}/${threadId0x}) stack of java process(${pid}) under user(${user}).&quot;
                echo
                rm ${jstackFile}
                continue
            }
        }
        blueEcho &quot;[$((count++))] Busy(${pcpu}%) thread(${threadId}/${threadId0x}) stack of java process(${pid}) under user(${user}):&quot;
        sed &quot;/nid=${threadId0x} /,/^$/p&quot; -n ${jstackFile}
    done
}


ps -Leo pid,lwp,user,comm,pcpu --no-headers | {
    [ -z &quot;${pid}&quot; ] &amp;&amp;
    awk &apos;$4==&quot;java&quot;{print $0}&apos; ||
    awk -v &quot;pid=${pid}&quot; &apos;$1==pid,$4==&quot;java&quot;{print $0}&apos;
} | sort -k5 -r -n | head --lines &quot;${count}&quot; | printStackOfThreads
</code></pre>
<h2 id="&#x5185;&#x5B58;&#x8FC7;&#x9AD8;"><a name="&#x5185;&#x5B58;&#x8FC7;&#x9AD8;" class="anchor-navigation-ex-anchor" href="#&#x5185;&#x5B58;&#x8FC7;&#x9AD8;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.1.5. &#x5185;&#x5B58;&#x8FC7;&#x9AD8;</h2>
<ul>
<li><p>jstat -gccause pid 1000 10//&#x67E5;&#x770B;&#x5185;&#x5B58;&#x4F7F;&#x7528;&#x60C5;&#x51B5;</p>
<p>```text
-gccause</p>
<p>S0&#xFF1A;&#x5E74;&#x8F7B;&#x4EE3;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;Survivor&#x533A;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
S1&#xFF1A;&#x5E74;&#x8F7B;&#x4EE3;&#x4E2D;&#x7B2C;&#x4E8C;&#x4E2A;Survivor&#x533A;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
E&#xFF1A;Eden&#x533A;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
O&#xFF1A;&#x8001;&#x5E74;&#x4EE3;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
M&#xFF1A;&#x5143;&#x7A7A;&#x95F4;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
CCS&#xFF1A;&#x538B;&#x7F29;&#x7C7B;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
YGC&#xFF1A;Young GC&#x7684;&#x6B21;&#x6570;&#x3002;
YGCT&#xFF1A;Young GC&#x6240;&#x7528;&#x7684;&#x65F6;&#x95F4;&#x3002;
FGC&#xFF1A;Full GC&#x7684;&#x6B21;&#x6570;&#x3002;
FGCT&#xFF1A;Full GC&#x7684;&#x6240;&#x7528;&#x7684;&#x65F6;&#x95F4;&#x3002;
GCT&#xFF1A;GC&#x7684;&#x6240;&#x7528;&#x7684;&#x603B;&#x65F6;&#x95F4;&#x3002;
LGCC&#xFF1A;&#x4E0A;&#x6B21;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x539F;&#x56E0;&#x3002;
GCC&#xFF1A;&#x5F53;&#x524D;&#x5783;&#x573E;&#x56DE;&#x6536;&#x7684;&#x539F;&#x56E0;&#x3002;</p>
</li>
</ul>
<p>  -gcutil&#x9009;&#x9879;
  S0&#xFF1A;&#x5E74;&#x8F7B;&#x4EE3;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;Survivor&#x533A;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
  S1&#xFF1A;&#x5E74;&#x8F7B;&#x4EE3;&#x4E2D;&#x7B2C;&#x4E8C;&#x4E2A;Survivor&#x533A;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
  E&#xFF1A;Eden&#x533A;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
  O&#xFF1A;&#x8001;&#x5E74;&#x4EE3;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
  M&#xFF1A;&#x5143;&#x7A7A;&#x95F4;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
  CCS&#xFF1A;&#x538B;&#x7F29;&#x7C7B;&#x4F7F;&#x7528;&#x5927;&#x5C0F;&#x5360;&#x5F53;&#x524D;&#x5BB9;&#x91CF;&#x7684;&#x767E;&#x5206;&#x6BD4;&#x3002;
  YGC&#xFF1A;Young GC&#x7684;&#x6B21;&#x6570;&#x3002;
  YGCT&#xFF1A;Young GC&#x6240;&#x7528;&#x7684;&#x65F6;&#x95F4;&#x3002;
  FGC&#xFF1A;Full GC&#x7684;&#x6B21;&#x6570;&#x3002;
  FGCT&#xFF1A;Full GC&#x7684;&#x6240;&#x7528;&#x7684;&#x65F6;&#x95F4;&#x3002;
  GCT&#xFF1A;GC&#x7684;&#x6240;&#x7528;&#x7684;&#x603B;&#x65F6;&#x95F4;&#x3002;</p>
<pre><code>

- jstack -l pid //&#x7EBF;&#x7A0B;&#x7167;&#x5206;&#x6790;

- jmap -histo:live pid | head -n20 //&#x5806;&#x7167;&#x6700;&#x5927;
</code></pre><h2 id="1&#x3001;&#x5185;&#x5B58;&#x5FEB;&#x7167;pid&#x4E3A;&#x7EBF;&#x7A0B;id"><a name="1&#x3001;&#x5185;&#x5B58;&#x5FEB;&#x7167;pid&#x4E3A;&#x7EBF;&#x7A0B;id" class="anchor-navigation-ex-anchor" href="#1&#x3001;&#x5185;&#x5B58;&#x5FEB;&#x7167;pid&#x4E3A;&#x7EBF;&#x7A0B;id"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.1.6. 1&#x3001;&#x5185;&#x5B58;&#x5FEB;&#x7167;,pid&#x4E3A;&#x7EBF;&#x7A0B;id</h2>
<p>jmap -dump:live,format=b,file=/tmp/jmap1.hporf PID</p>
<h2 id="2&#x3001;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;"><a name="2&#x3001;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;" class="anchor-navigation-ex-anchor" href="#2&#x3001;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.1.7. 2&#x3001;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;</h2>
<p>ps -ef|grep java|grep -v grep|awk &apos;{print $2}&apos;|xargs jmap -dump:live,format=b,file=api.bin</p>
<h1 id="3&#x3001;&#x5185;&#x5B58;oom&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x751F;&#x6210;dump&#x6587;&#x4EF6;&#xFF0C;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x914D;&#x7F6E;"><a name="3&#x3001;&#x5185;&#x5B58;oom&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x751F;&#x6210;dump&#x6587;&#x4EF6;&#xFF0C;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x914D;&#x7F6E;" class="anchor-navigation-ex-anchor" href="#3&#x3001;&#x5185;&#x5B58;oom&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x751F;&#x6210;dump&#x6587;&#x4EF6;&#xFF0C;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x914D;&#x7F6E;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2. 3&#x3001;&#x5185;&#x5B58;OOM&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x751F;&#x6210;dump&#x6587;&#x4EF6;&#xFF0C;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x914D;&#x7F6E;</h1>
<p>-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/data/logs/</p>
<h2 id="&#x538B;&#x7F29;&#x6587;&#x4EF6;-&#x6587;&#x4EF6;&#x540D;&#x3001;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;"><a name="&#x538B;&#x7F29;&#x6587;&#x4EF6;-&#x6587;&#x4EF6;&#x540D;&#x3001;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;" class="anchor-navigation-ex-anchor" href="#&#x538B;&#x7F29;&#x6587;&#x4EF6;-&#x6587;&#x4EF6;&#x540D;&#x3001;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.1. &#x538B;&#x7F29;&#x6587;&#x4EF6; &#x6587;&#x4EF6;&#x540D;&#x3001;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;</h2>
<p>tar -czvf test1.tar.gz /tmp/test1.hporf</p>
<h2 id="&#x89E3;&#x538B;"><a name="&#x89E3;&#x538B;" class="anchor-navigation-ex-anchor" href="#&#x89E3;&#x538B;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.2. &#x89E3;&#x538B;</h2>
<p>tar -zxvf test1.tar.gz</p>
<pre><code>
- GC

| GC &#x540D;&#x79F0; | &#x4F5C;&#x7528;                                   | &#x8BF4;&#x660E;                                                         |
| ------- | -------------------------------------- | ------------------------------------------------------------ |
| MinorGC | &#x6E05;&#x7406;&#x65B0;&#x751F;&#x4EE3;                             |                                                              |
| MajorGC | &#x6E05;&#x7406;&#x8001;&#x5E74;&#x4EE3;                             | &#x6536;&#x96C6;&#x8001;&#x5E74;&#x4EE3;&#x7684;&#x65F6;&#x5019;&#x5F80;&#x5F80;&#x4E5F;&#x4F1A;&#x4F34;&#x968F;&#x5347;&#x7EA7;&#x5E74;&#x8F7B;&#x4EE3;&#xFF0C;&#x6536;&#x96C6;&#x6574;&#x4E2A;java&#x5806;&#xFF0C;&#x548C;full gc &#x7B49;&#x4EF7; |
| Full GC | &#x65B0;&#x751F;&#x4EE3;&#xFF0C;&#x8001;&#x5E74;&#x4EE3;&#x7EDF;&#x4E00;&#x56DE;&#x6536;(&#x5143;&#x7A7A;&#x95F4;&#x4E0D;&#x5C5E;&#x4E8E;&#x5806;) |                                                              |
| mixedGC | &#x65B0;&#x751F;&#x4EE3;+&#x90E8;&#x5206;&#x8001;&#x751F;&#x4EE3;                      | G1 &#x7279;&#x6709;                                                      |
|         |                                        |                                                              |

- GC&#x89E6;&#x53D1;&#x573A;&#x666F;

| Young GC                                       | Full GC                                  |
| ---------------------------------------------- | ---------------------------------------- |
| Eden&#x5185;&#x5B58;&#x4E0D;&#x8DB3;                                   | old Gen&#x5185;&#x5B58;&#x4E0D;&#x8DB3;                          |
| &#x4E3A;TLAB&#x5206;&#x914D;&#x5185;&#x5B58;                                 | Young&#x664B;&#x5347;&#x5230;old Gen&#x5BF9;&#x8C61;&#x603B;&#x5185;&#x5B58;&#x5927;&#x4E8E;&#x5269;&#x4F59;&#x5185;&#x5B58; |
| Eden&#x5E74;&#x9F84;&#x6807;&#x8BB0;age&#x5E74;&#x8FBE;&#x5230;&#x9650;&#x5B9A;&#x6570;&#x7684;&#x5BF9;&#x8C61;&#x4F1A;&#x664B;&#x5347;old Gen | Young gc&#x51FA;&#x73B0; promotion failure           |
| &#x65E0;                                             | &#x6267;&#x884C;system.gc()&#x3001;jmap -histo:live        |

- GC roots &#x5BF9;&#x8C61;

1. &#x865A;&#x62DF;&#x673A;&#x6808;(&#x6808;&#x6862;&#x4E2D;&#x7684;&#x672C;&#x5730;&#x53D8;&#x91CF;&#x8868;)&#x4E2D;&#x7684;&#x5F15;&#x7528;&#x5BF9;&#x8C61;&#xFF0C;&#x6240;&#x6307;java&#x5BF9;&#x8C61;&#xFF0C;&#x5B58;&#x653E;&#x5230;&#x5806;&#x4E2D;
2. &#x65B9;&#x6CD5;&#x533A;&#x4E2D;&#x7684;&#x7C7B;&#x9759;&#x6001;&#x5C5E;&#x6027;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x4E00;&#x822C;&#x6307;&#x88AB;static&#x4FEE;&#x9970;&#x5F15;&#x7528;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x52A0;&#x8F7D;&#x7C7B;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x88AB;&#x52A0;&#x8F7D;&#x5230;&#x5185;&#x5B58;&#x4E2D;
3. &#x65B9;&#x6CD5;&#x533A;&#x4E2D;&#x7684;&#x5E38;&#x91CF;&#x5F15;&#x7528;&#x5BF9;&#x8C61;
4. &#x672C;&#x5730;&#x65B9;&#x6CD5;&#x6808;&#x4E2D;JNI(native&#x65B9;&#x6CD5;)&#x5F15;&#x7528;&#x5BF9;&#x8C61;

- GC&#x7B97;&#x6CD5;

![image-20220726085835346](../../assets/image-20220726085835346.png)

1. &#x4E32;&#x884C;&#x53EA;&#x4F7F;&#x7528;&#x5355;&#x6761;GC&#x7EBF;&#x7A0B;&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x5E76;&#x884C;&#x4F7F;&#x7528;&#x591A;&#x6761;
2. &#x591A;&#x6838;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5E76;&#x884C;&#x4E00;&#x822C;&#x66F4;&#x6709;&#x6267;&#x884C;&#x6548;&#x7387;&#xFF0C;&#x4F46;&#x662F;&#x5355;&#x6838;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5E76;&#x884C;&#x672A;&#x5FC5;&#x6BD4;&#x4E32;&#x884C;&#x66F4;&#x6709;&#x6548;&#x7387;

![image-20220726090050786](../../assets/image-20220726090050786.png)

1. STW&#x4F1A;&#x6682;&#x505C;&#x6240;&#x6709;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#xFF0C;&#x7B49;&#x5F85;GC&#x7EBF;&#x7A0B;&#x5B8C;&#x6210;&#x540E;&#x5728;&#x7EE7;&#x7EED;&#x6267;&#x884C;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x77ED;&#x65F6;&#x95F4;&#x5185;&#x5E94;&#x7528;&#x65E0;&#x54CD;&#x5E94;
2. Concurrent&#x4F1A;&#x5BFC;&#x81F4;GC&#x7EBF;&#x7A0B;&#x548C;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x5E76;&#x53D1;&#x6267;&#x884C;&#xFF0C;&#x56E0;&#x6B64;&#x5E94;&#x7528;&#x7EBF;&#x7A0B;&#x548C;GC&#x7EBF;&#x7A0B;&#x4E92;&#x76F8;&#x62A2;&#x7528;cpu&#xFF0C;&#x4ECE;&#x800C;&#x5BFC;&#x81F4;&#x51FA;&#x73B0;&#x6D6E;&#x52A8;&#x5783;&#x573E;&#xFF0C;&#x540C;&#x65F6;GC&#x65F6;&#x95F4;&#x4E0D;&#x53EF;&#x63A7;

### GC&#x7B97;&#x6CD5;

#### &#x65B0;&#x751F;&#x4EE3;&#x4F7F;&#x7528;GC&#x7B97;&#x6CD5;

| Young             | &#x7279;&#x5F81;           | &#x9002;&#x7528;&#x573A;&#x666F;                     | &#x664B;&#x5347;&#x89C4;&#x5219;                                      |
| ----------------- | -------------- | ---------------------------- | --------------------------------------------- |
| serial copying    | Serial + STW   | client&#x7EA7;&#x522B;&#x6216;32bit window&#x673A;&#x5668; | to&#x533A;&#x653E;&#x4E0D;&#x4E0B;/&#x591A;&#x6B21;Minor GC&#x4F9D;&#x7136;&#x5B58;&#x6D3B;               |
| Parallel Scavenge | Paralled+STW   | &#x591A;&#x6838;CPU+&#x5927;&#x541E;&#x5410;&#x91CF;+&#x540E;&#x53F0;&#x8BA1;&#x7B97;&#x578B;  | to&#x533A;&#x653E;&#x4E0D;&#x4E0B;/&#x591A;&#x6B21;Minor GC&#x4F9D;&#x7136;&#x5B58;&#x6D3B;(&#x6BD4;serial&#x590D;&#x6742;) |
| ParNew            | Parallel + STW | &#x4E92;&#x8054;&#x7F51;&#x7B49;&#x8981;&#x6C42;&#x6781;&#x81F4;&#x4F53;&#x9A8C;&#x7684;&#x5E94;&#x7528;   |                                               |

- &#x65B0;&#x751F;&#x4EE3;&#x7B97;&#x6CD5;&#x57FA;&#x4E8E;coping&#xFF0C;&#x901F;&#x5EA6;&#x5FEB;
- Paralled Scavenge : &#x541E;&#x5410;&#x91CF;&#x4F18;&#x5148;
    - &#x541E;&#x5410;&#x91CF; = &#x8FD0;&#x884C;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x65F6;&#x95F4;/&#xFF08;&#x8FD0;&#x884C;&#x7528;&#x6237;&#x4EE3;&#x7801;&#x65F6;&#x95F4; + &#x5783;&#x573E;&#x6536;&#x96C6;&#x65F6;&#x95F4;&#xFF09;

#### &#x8001;&#x5E74;&#x4EE3;&#x4F7F;&#x7528;GC&#x7B97;&#x6CD5;

| OLD                        | &#x7279;&#x5F81;             | &#x9002;&#x7528;&#x573A;&#x666F;                                     | &#x7B97;&#x6CD5;                                   |
| -------------------------- | ---------------- | -------------------------------------------- | -------------------------------------- |
| serial MSC                 | Serial + STW     | client&#x7EA7;&#x522B;&#x6216;32bit window&#x673A;&#x5668;                 | Mark-sweep-Compact                     |
| Parallel Compacting        | Paralled+STW     | &#x591A;&#x6838;CPU+&#x5927;&#x541E;&#x5410;&#x91CF;+&#x540E;&#x53F0;&#x8BA1;&#x7B97;&#x578B;                  | Mark(&#x5E76;&#x884C;)-summary(&#x4E32;&#x884C;)-compact(&#x5E76;&#x884C;) |
| Concurrent Mark-Sweep(CMS) | Concurrent + STW | &#x591A;&#x6838;cpu+ &#x4F4E;&#x505C;&#x987F; + &#x4E92;&#x8054;&#x7F51;&#x7B49;&#x8981;&#x6C42;&#x6781;&#x81F4;&#x4F53;&#x9A8C;&#x7684;&#x5E94;&#x7528; | Mark(&#x5E76;&#x884C;)-summary(&#x4E32;&#x884C;)-compact(&#x5E76;&#x884C;) |

![image-20220726091336031](../../assets/image-20220726091336031.png)

![image-20220726091357923](../../assets/image-20220726091357923.png)

#### &#x5783;&#x573E;&#x6536;&#x96C6;&#x5668;&#x603B;&#x7ED3;

| &#x6536;&#x96C6;&#x5668;            | &#x4E32;&#x884C;&#x3001;&#x5E76;&#x884C;or&#x5E76;&#x53D1; | &#x65B0;&#x751F;&#x4EE3;/&#x8001;&#x5E74;&#x4EE3;  | &#x7B97;&#x6CD5;               | &#x76EE;&#x6807;         | &#x4F7F;&#x7528;&#x573A;&#x666F;                             |
| ----------------- | ---------------- | -------------- | ------------------ | ------------ | ------------------------------------ |
| Serial            | &#x4E32;&#x884C;             | &#x65B0;&#x751F;&#x4EE3;         | &#x590D;&#x5236;&#x7B97;&#x6CD5;           | &#x54CD;&#x5E94;&#x901F;&#x5EA6;&#x4F18;&#x5148; | &#x5355;cpu&#x73AF;&#x5883;&#x4E0B;&#x7684;client&#x6A21;&#x578B;              |
| Serial old        | &#x4E32;&#x884C;             | &#x8001;&#x5E74;&#x4EE3;         | &#x6807;&#x8BB0;-&#x6574;&#x7406;          | &#x54CD;&#x5E94;&#x901F;&#x5EA6;&#x4F18;&#x5148; | &#x5355;cpu&#x73AF;&#x5883;&#x4E0B;&#x7684;client&#x6A21;&#x578B;&#x3001;cms&#x540E;&#x5907;&#x9884;&#x6848; |
| ParNew            | &#x5E76;&#x884C;             | &#x65B0;&#x751F;&#x4EE3;         | &#x590D;&#x5236;&#x7B97;&#x6CD5;           | &#x54CD;&#x5E94;&#x901F;&#x5EA6;&#x4F18;&#x5148; | &#x591A;cpu&#x73AF;&#x5883;&#x65F6;&#x5728;Server&#x6A21;&#x5F0F;&#x4E0B;CMS&#x914D;&#x5408;     |
| Parallel Scavenge | &#x5E76;&#x884C;             | &#x65B0;&#x751F;&#x4EE3;         | &#x590D;&#x5236;&#x7B97;&#x6CD5;           | &#x541E;&#x5410;&#x91CF;&#x4F18;&#x5148;   | &#x5728;&#x540E;&#x53F0;&#x8FD0;&#x7B97;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x592A;&#x591A;&#x4EA4;&#x4E92;&#x7684;&#x4EFB;&#x52A1;     |
| Parallel Old      | &#x5E76;&#x53D1;             | &#x8001;&#x5E74;&#x4EE3;         | &#x6807;&#x8BB0;-&#x6574;&#x7406;          | &#x541E;&#x5410;&#x91CF;&#x4F18;&#x5148;   | &#x5728;&#x540E;&#x53F0;&#x8FD0;&#x7B97;&#x800C;&#x4E0D;&#x9700;&#x8981;&#x592A;&#x591A;&#x4EA4;&#x4E92;&#x7684;&#x4EFB;&#x52A1;     |
| CMS               | &#x5E76;&#x53D1;             | &#x8001;&#x5E74;&#x4EE3;         | &#x6807;&#x8BB0;-&#x6E05;&#x695A;          | &#x54CD;&#x5E94;&#x901F;&#x5EA6;&#x4F18;&#x5148; | &#x96C6;&#x4E2D;&#x5728;&#x4E92;&#x8054;&#x7F51;&#x7AD9;B/S&#x7CFB;&#x7EDF;&#x670D;&#x52A1;&#x7AEF;java&#x5E94;&#x7528;  |
| G1                | &#x5E76;&#x53D1;             | &#x65B0;&#x751F;&#x4EE3;&#x548C;&#x8001;&#x5E74;&#x4EE3; | &#x6807;&#x8BB0;+&#x6574;&#x7406;+&#x590D;&#x5236;&#x7B97;&#x6CD5; | &#x54CD;&#x5E94;&#x901F;&#x5EA6;&#x4F18;&#x5148; | &#x9762;&#x5411;&#x670D;&#x52A1;&#x7AEF;&#x5E94;&#x7528;&#xFF0C;&#x5C06;&#x6765;&#x66FF;&#x6362;CMS          |
|                   |                  |                |                    |              |                                      |

![image-20220726092404107](../../assets/image-20220726092404107.png)

## mysql

### &#x5E38;&#x7528;&#x7CFB;&#x7EDF;&#x53D8;&#x91CF;&#x548C;&#x72B6;&#x6001;&#x53D8;&#x91CF;

```sql
#
&#x67E5;&#x8BE2;&#x6162;SQL&#x67E5;&#x8BE2;&#x662F;&#x5426;&#x5F00;&#x542F;
show variables like &apos;slow_query_log&apos;;
#
&#x67E5;&#x8BE2;&#x6162;SQL&#x7684;&#x65F6;&#x95F4;
show variables like &apos;long_query_time&apos;;
#
&#x67E5;&#x770B;&#x6162;SQL&#x5B58;&#x653E;&#x8DEF;&#x5F84;&#xFF0C;&#x4E00;&#x822C;&#xFF1A;/home/mysql/data3016/mysql/slow_query.log
show variables like &apos;slow_query_log_file&apos;;

#
&#x67E5;&#x770B;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x7EA7;&#x522B;,RDS:READ-COMMITTED   Mysql:Repeatable read
show variables like &apos;tx_isolation&apos;; 
 #
innodb&#x6570;&#x636E;&#x9875;&#x5927;&#x5C0F;  16384
show variables like &apos;innodb_page_size&apos;; 
show
status  like &apos;innodb_row_%&apos;;

#
&#x67E5;&#x770B;&#x6162;SQL
SHOW SLOW limit 10;
show full
slow limit 10;

#
&#x67E5;&#x770B;autocommit&#x914D;&#x7F6E;
select @@autocommit;
#
&#x540C;&#x4E0A;
show variables like &apos;autocommit&apos;; 
#&#x8BBE;&#x7F6E;SQL&#x81EA;&#x52A8;&#x63D0;&#x4EA4;&#x6A21;&#x5F0F;
1:&#x9ED8;&#x8BA4;,&#x81EA;&#x52A8;&#x63D0;&#x4EA4;   0:&#x9700;&#x8981;&#x624B;&#x52A8;&#x89E6;&#x53D1;commit,&#x5426;&#x5219;&#x4E0D;&#x4F1A;&#x751F;&#x6548;
set autocommit=1;
&#x3000;&#x3000;
# &#x67E5;&#x770B;&#x9ED8;&#x8BA4;&#x7684;&#x641C;&#x7D22;&#x5F15;&#x64CE;
show variables like &apos;%storage_engine%&apos;; 
#
&#x8BBE;&#x7F6E;&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x7EA7;&#x522B;
SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
</code></pre><h3 id="&#x4E8B;&#x7269;"><a name="&#x4E8B;&#x7269;" class="anchor-navigation-ex-anchor" href="#&#x4E8B;&#x7269;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.2.1. &#x4E8B;&#x7269;</h3>
<pre><code>SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;  
-- READ UNCOMMITTED/READ COMMITTED/REPEATABLE READ/SERIALIZABLE
</code></pre><ul>
<li>&#x810F;&#x8BFB;(&#x4E8B;&#x7269;&#x5C1A;&#x672A; &#x63D0;&#x4EA4;&#x6570;&#x636E;&#x4E5F;&#x88AB;&#x8BFB;&#x53D6;&#xFF0C;READ UNCOMMITTED)</li>
<li><p>&#x4E0D;&#x53EF;&#x91CD;&#x590D;&#x8BFB;(&#x540C;&#x6837;&#x7684;&#x6761;&#x4EF6;, &#x4F60;&#x8BFB;&#x53D6;&#x8FC7;&#x7684;&#x6570;&#x636E;, &#x518D;&#x6B21;&#x8BFB;&#x53D6;&#x51FA;&#x6765;&#x53D1;&#x73B0;&#x503C;&#x4E0D;&#x4E00;&#x6837;&#x4E86;)</p>
</li>
<li><p>&#x5E7B;&#x8BFB;(GAP&#x9501;&#xFF0C;&#x65B0;&#x589E;&#x6216;&#x8005;&#x5220;&#x9664;&#x6570;&#x636E;&#x6761;&#x6570;&#x53D1;&#x751F;&#x53D8;&#x5316;&#xFF0C;innodb&#x4F7F;&#x7528;2&#x4E2D;&#x6280;&#x672F;&#x624B;&#x6BB5;&#x653E;&#x7F6E;&#x5E7B;&#x8BFB; MVCC AND GAP LOCK)</p>
</li>
</ul>
<p><img src="../../assets/image-20220726100544375.png" alt="image-20220726100544375"></p>
<h3 id="innodb&#x591A;&#x79CD;&#x9501;"><a name="innodb&#x591A;&#x79CD;&#x9501;" class="anchor-navigation-ex-anchor" href="#innodb&#x591A;&#x79CD;&#x9501;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.2.2. innodb&#x591A;&#x79CD;&#x9501;</h3>
<h4 id="&#x9501;&#x7C7B;&#x578B;"><a name="&#x9501;&#x7C7B;&#x578B;" class="anchor-navigation-ex-anchor" href="#&#x9501;&#x7C7B;&#x578B;"><i class="fa fa-link" aria-hidden="true"></i></a>&#x9501;&#x7C7B;&#x578B;</h4>
<table>
<thead>
<tr>
<th>&#x9501;&#x7C7B;&#x578B;</th>
<th>&#x662F;&#x5426;&#x6B7B;&#x9501;</th>
<th>&#x522B;&#x540D;</th>
<th>&#x6CE8;&#x610F;&#x70B9;</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x8868;&#x7EA7;&#x9501;</td>
<td>&#x65E0;&#x6B7B;&#x9501;</td>
<td>&#x9501;&#x5B9A;&#x6574;&#x4E2A;&#x8868;</td>
<td>myisam&#x548C;Memory&#x5B58;&#x50A8;&#x5F15;&#x64CE;</td>
</tr>
<tr>
<td>&#x9875;&#x7EA7;&#x9501;</td>
<td>&#x6709;&#x6B7B;&#x9501;</td>
<td>&#x9501;&#x5B9A;&#x4E00;&#x9875;</td>
<td>BoB&#x5B58;&#x50A8;&#x5F15;&#x64CE;</td>
</tr>
<tr>
<td>&#x884C;&#x7EA7;&#x9501;</td>
<td>&#x6709;&#x6B7B;&#x9501;</td>
<td>&#x9501;&#x5B9A;&#x4E00;&#x884C;</td>
<td>innoDB&#x5F15;&#x64CE; &#x9501;&#x7D22;&#x5F15; &#x9501;&#x5B9A;&#x4E3B;&#x952E;&#x7D22;&#x5F15;</td>
</tr>
</tbody>
</table>
<ul>
<li>&#x8868;&#x9501;&#x4F18;&#x52BF;&#xFF1A;&#x5F00;&#x9500;&#x5C0F;&#xFF1B;&#x52A0;&#x9501;&#x5FEB;&#xFF1B;&#x65E0;&#x6B7B;&#x9501;</li>
<li>&#x8868;&#x9501;&#x7F3A;&#x70B9;&#xFF1A;&#x9501;&#x7C92;&#x5EA6;&#x5927;&#xFF0C;&#x53D1;&#x9001;&#x9501;&#x51B2;&#x7A81;&#x6539;&#x4E86;&#x9AD8;&#xFF0C;&#x5E76;&#x884C;&#x5904;&#x7406;&#x80FD;&#x529B;&#x4F4E;</li>
<li>&#x52A0;&#x9501;&#x65B9;&#x5F0F;&#xFF1A;&#x81EA;&#x52A8;&#x52A0;&#x9501;&#x3002;&#x67E5;&#x8BE2;&#x4F1A;&#x81EA;&#x52A8;&#x7ED9;&#x6D89;&#x53CA;&#x6240;&#x6709;&#x8868;&#x52A0;&#x8BFB;&#x9501;&#xFF0C;&#x66F4;&#x65B0;&#x81EA;&#x52A8;&#x7ED9;&#x8868;&#x5199;&#x9501;</li>
<li>&#x5171;&#x4EAB;&#x9501;&#xFF1A;lock table tableName read</li>
<li>&#x72EC;&#x5360;&#x5199;&#x9501;: lock tablet able write</li>
<li>&#x6279;&#x91CF;&#x89E3;&#x9501;&#xFF1A;unlock tables</li>
<li>&#x884C;&#x9501;(&#x53EA;&#x5728;Repeatable read&#x548C;Serializable&#x4E24;&#x79CD;&#x4E8B;&#x52A1;&#x9694;&#x79BB;&#x7EA7;&#x522B;&#x4E0B;&#x624D;&#x4F1A;&#x53D6;&#x5F97;&#x9501;&#x3002;)<ul>
<li>Record lock &#xFF0C;&#x5355;&#x6761;&#x7D22;&#x5F15;&#x52A0;&#x4E0A;&#x9501;&#xFF0C;&#x6C38;&#x8FDC;&#x662F;&#x9501;&#x7D22;&#x5F15;&#x800C;&#x975E;&#x8BB0;&#x5F55;</li>
<li>Gap lock(&#x95F4;&#x9699;&#x9501;)&#xFF0C;&#x7D22;&#x5F15;&#x8BB0;&#x5F55;&#x4E4B;&#x95F4;&#x7684;&#x95F4;&#x9699;&#x4E2D;&#x52A0;&#x9501;&#xFF0C;&#x89E3;&#x51B3;&#x5E7B;&#x8BFB;&#x95EE;&#x9898;</li>
<li>Next-key lock , Record lock&#x548C;gap lock &#x7ED3;&#x5408;&#xFF0C;&#x5373;&#x9664;&#x4E86;&#x9501;&#x4F4F;&#x8BB0;&#x5F55;&#x672C;&#x8EAB;&#xFF0C;&#x8FD8;&#x8981;&#x9501;&#x4F4F;&#x7D22;&#x5F15;&#x4E4B;&#x95F4;&#x7684;&#x95F4;&#x9699;</li>
</ul>
</li>
<li>&#x610F;&#x5411;&#x9501;</li>
</ul>
<p>&#x5728;&#x65E0;&#x610F;&#x5411;&#x9501;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;step2&#x9700;&#x8981;&#x904D;&#x5386;&#x6574;&#x4E2A;&#x8868;,&#x624D;&#x80FD;&#x786E;&#x8BA4;&#x662F;&#x5426;&#x80FD;&#x62FF;&#x5230;&#x8868;&#x9501;&#x3002;&#x800C;&#x5728;&#x610F;&#x5411;&#x9501;&#x5B58;&#x5728;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x4E8B;&#x52A1;A&#x5FC5;&#x987B;&#x5148;&#x7533;&#x8BF7;&#x8868;&#x7684;&#x610F;&#x5411;&#x5171;&#x4EAB;&#x9501;&#xFF0C;&#x6210;&#x529F;&#x540E;&#x518D;&#x7533;&#x8BF7;&#x4E00;&#x884C;&#x7684;&#x884C;&#x9501;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x518D;&#x904D;&#x5386;&#x6574;&#x4E2A;&#x8868;&#xFF0C;&#x63D0;&#x5347;&#x4E86;&#x6548;&#x7387;&#x3002;&#x56E0;&#x6B64;&#x610F;&#x5411;&#x9501;&#x4E3B;&#x8981;&#x662F;&#x4E3A;&#x4E86;&#x5B9E;&#x73B0;&#x591A;&#x7C92;&#x5EA6;&#x9501;&#x673A;&#x5236;&#xFF08;&#x767D;&#x8BDD;&#xFF1A;&#x4E3A;&#x4E86;&#x8868;&#x9501;&#x548C;&#x884C;&#x9501;&#x90FD;&#x80FD;&#x7528;&#xFF09;&#x3002;</p>
<ul>
<li>X/S&#x9501;</li>
</ul>
<table>
<thead>
<tr>
<th>&#x9501;&#x7C7B;&#x578B;</th>
<th>&#x4F7F;&#x7528;&#x573A;&#x666F;</th>
<th>&#x8BED;&#x6CD5;</th>
<th>&#x7279;&#x70B9;</th>
</tr>
</thead>
<tbody>
<tr>
<td>X&#x9501;(&#x6392;&#x5B83;&#x9501;)</td>
<td>&#x4E8B;&#x7269;A&#x67E5;&#x5230;&#x7684;&#x6570;&#x636E;&#x65F6;&#x6700;&#x65B0;&#xFF0C;&#x4E14;&#x6570;&#x636E;&#x53EA;&#x5141;&#x8BB8;&#x81EA;&#x5DF1;&#x4FEE;&#x6539;&#xFF0C;&#x4E0D;&#x5141;&#x8BB8;&#x5176;&#x4ED6;&#x4E8B;&#x7269;&#x4FEE;&#x6539;</td>
<td>Update/delete/insert/select  from table for update*</td>
<td>&#x76F8;&#x5F53;&#x4E8E;update,&#x5F71;&#x54CD;&#x5E76;&#x53D1;&#xFF0C;&#x53EA;&#x6709;&#x7B2C;&#x4E00;&#x4E2A;&#x4E8B;&#x7269;&#x53EF;&#x4EE5;&#x83B7;&#x5F97;X&#x9501;&#xFF0C;&#x5176;&#x4ED6;&#x4E8B;&#x7269;&#x83B7;&#x53D6;&#x65F6;&#x4F1A;&#x5931;&#x8D25;</td>
</tr>
<tr>
<td>S&#x9501;&#xFF08;&#x5171;&#x4EAB;&#x9501;&#xFF09;</td>
<td>&#x4E8B;&#x7269;A&#x67E5;&#x5230;&#x7684;&#x6700;&#x65B0;&#x6570;&#x636E;&#xFF0C;&#x4E0D;&#x5141;&#x8BB8;&#x5176;&#x4ED6;&#x4E8B;&#x7269;&#x4FEE;&#x6539;&#xFF0C;&#x81EA;&#x5DF1;&#x4E5F;&#x4E0D;&#x4E00;&#x5B9A;&#x80FD;&#x4FEE;&#x6539;&#x6210;&#x529F;&#xFF0C;&#x56E0;&#x4E3A;&#x5176;&#x4ED6;&#x4E8B;&#x7269;&#x4E5F;&#x53EF;&#x80FD;&#x62FF;&#x5230;S&#x9501;</td>
<td>select from table lock in share mode*</td>
<td>&#x591A;&#x4E2A;&#x4E8B;&#x7269;&#x90FD;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;S&#x9501;&#xFF0C;&#x4F46;&#x5982;&#x679C;A/b&#x90FD;&#x62FF;&#x5230;S&#x9501;&#xFF0C;A/B&#x5728;&#x4FEE;&#x6539;&#x65F6;&#x63D0;&#x4EA4;&#x4E0D;&#x4E86;&#xFF0C;&#x76F4;&#x5230;&#x8D85;&#x65F6;</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="&#x6B7B;&#x9501;"><a name="&#x6B7B;&#x9501;" class="anchor-navigation-ex-anchor" href="#&#x6B7B;&#x9501;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.2.3. &#x6B7B;&#x9501;</h3>
<pre><code>## &#x65E5;&#x5FD7;&#x5173;&#x952E;&#x8BCD;
Deadlock found when trying to get lock; try restarting transaction ;
</code></pre><ul>
<li>select @@tx_isolation &#x67E5;&#x770B;&#x6570;&#x636E;&#x5E93;&#x9694;&#x79BB;&#x7EA7;&#x522B;( &#x6216;&#x8005; show variables like &apos;tx_isolation&apos; ;)</li>
</ul>
<pre><code># status&#x4EE3;&#x8868;&#x5F53;&#x524D;&#x7CFB;&#x7EDF;&#x7684;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#xFF0C;&#x53EA;&#x80FD;&#x67E5;&#x770B;&#xFF0C;&#x4E0D;&#x80FD;&#x4FEE;&#x6539;
show status like &apos;%abc%&apos;;
show variables like &apos;%abc%&apos;;
</code></pre><p><img src="../../assets/image-20220725200517631.png" alt="image-20220725200517631"></p>
<ul>
<li><p>show engine innodb status &#x67E5;&#x770B;&#x6B7B;&#x9501;&#x4FE1;&#x606F;</p>
<p>&#x6B7B;&#x9501;&#x89E6;&#x53D1;&#x6D41;&#x7A0B;</p>
</li>
</ul>
<p><img src="../../assets/image-20220725200710727.png" alt="image-20220725200710727"></p>
<h2 id="&#x6162;sql"><a name="&#x6162;sql" class="anchor-navigation-ex-anchor" href="#&#x6162;sql"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.3. &#x6162;sql</h2>
<ul>
<li>&#x6267;&#x884C;&#x8BA1;&#x5212;,&#x589E;&#x52A0;&#x8868;&#x7D22;&#x5F15;</li>
</ul>
<p><img src="../../assets/image-20220725201003510.png" alt="image-20220725201003510"></p>
<ul>
<li>&#x4E8B;&#x7269;&#x60C5;&#x51B5;</li>
</ul>
<pre><code>-- &#x5F53;&#x524D;&#x8FD0;&#x884C;&#x7684;&#x6240;&#x6709;&#x4E8B;&#x52A1;
select *  from information_schema.innodb_trx;
-- &#x5F53;&#x524D;&#x51FA;&#x73B0;&#x7684;&#x9501;
SELECT * FROM information_schema.INNODB_LOCKS;
-- &#x9501;&#x7B49;&#x5F85;&#x7684;&#x5BF9;&#x5E94;&#x5173;&#x7CFB;
select *  from information_schema.INNODB_LOCK_WAITS;
</code></pre><p>&#x67E5;&#x770B;&#x4E8B;&#x52A1;&#x9501;&#x7C7B;&#x578B;&#x7D22;&#x5F15;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;,lock_table&#x5B57;&#x6BB5;&#x80FD;&#x770B;&#x5230;&#x88AB;&#x9501;&#x7684;&#x7D22;&#x5F15;&#x7684;&#x8868;&#x540D;&#xFF0C;lock_mode&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x9501;&#x7C7B;&#x578B;&#x662F;X&#x9501;,lock_type&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x662F;&#x884C;&#x9501;record&#x3002;</p>
<p><img src="../../assets/image-20220725201640085.png" alt="image-20220725201640085"></p>
<p>&#xFF08;1&#xFF09;&#x4FEE;&#x6539;&#x65B9;&#x6848;</p>
<p>&#x7531;&#x524D;&#x4E00;&#x6B65;&#x7684;&#x7ED3;&#x679C;,&#x5206;&#x6790;&#x4E8B;&#x52A1;&#x95F4;&#x52A0;&#x9501;&#x65F6;&#x5E8F;&#xFF0C;&#x4F8B;&#x5982;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;tx_query&#x5B57;&#x6BB5;&#x5F97;&#x77E5;&#x88AB;&#x963B;&#x585E;&#x7684;&#x4E8B;&#x52A1;SQL,trx_state&#x5F97;&#x77E5;&#x4E8B;&#x52A1;&#x72B6;&#x6001;&#x7B49;&#xFF0C;&#x627E;&#x5230;&#x5BF9;&#x5E94;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#xFF0C;&#x8FDB;&#x884C;&#x4F18;&#x5316;&#x4FEE;&#x6539;&#x3002;</p>
<p>&#xFF08;2&#xFF09;&#x4E34;&#x65F6;&#x4FEE;&#x6539;&#x65B9;&#x6848;</p>
<p>trx_mysql_thread_id&#x662F;&#x5BF9;&#x5E94;&#x7684;&#x4E8B;&#x52A1;sessionId&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x6740;&#x6B7B;&#x957F;&#x65F6;&#x95F4;&#x6267;&#x884C;&#x7684;&#x4E8B;&#x52A1;&#xFF0C;&#x4ECE;&#x800C;&#x907F;&#x514D;&#x963B;&#x585E;&#x5176;&#x4ED6;&#x4E8B;&#x52A1;&#x6267;&#x884C;&#x3002;</p>
<p>kill 104343</p>
<ul>
<li><p>&#x94FE;&#x63A5;&#x6570;&#x8FC7;&#x591A;</p>
<ul>
<li><p>&#x901A;&#x8FC7;set global max_connections=XXX&#x589E;&#x5927;&#x6700;&#x5927;&#x8FDE;&#x63A5;&#x6570;&#x3002;</p>
</li>
<li><p>&#x5148;&#x5229;&#x7528;show processlist&#x83B7;&#x53D6;&#x8FDE;&#x63A5;&#x4FE1;&#x606F;&#xFF0C;&#x7136;&#x540E;&#x5229;&#x7528;kill&#x6740;&#x6B7B;&#x8FC7;&#x591A;&#x94FE;&#x63A5;</p>
<pre><code class="lang-sql">&#x5E38;&#x7528;&#x811A;&#x672C;&#x6392;&#x5E8F;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x7684;&#x6570;&#x76EE; 
mysql -h127.0.0.0.1 -uabc_test -pXXXXX -P3306 -A -e &apos;<span class="hljs-keyword">show</span> <span class="hljs-keyword">processlist</span><span class="hljs-string">&apos;| awk &apos;</span>{print $<span class="hljs-number">4</span>}<span class="hljs-string">&apos;|sort|uniq -c|sort -rn|head -10
</span></code></pre>
</li>
</ul>
</li>
</ul>
<h2 id="&#x7F51;&#x7EDC;-&#x3001;ddos-&#x653B;&#x51FB;"><a name="&#x7F51;&#x7EDC;-&#x3001;ddos-&#x653B;&#x51FB;" class="anchor-navigation-ex-anchor" href="#&#x7F51;&#x7EDC;-&#x3001;ddos-&#x653B;&#x51FB;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.4. &#x7F51;&#x7EDC; &#x3001;DDOS &#x653B;&#x51FB;</h2>
<pre><code class="lang-text">## Server&#x4E0A;&#x6709;&#x5927;&#x91CF;&#x534A;&#x8FDE;&#x63A5;&#x72B6;&#x6001;&#x4E14;&#x6E90;IP&#x5730;&#x5740;&#x662F;&#x968F;&#x673A;&#x7684;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x65AD;&#x5B9A;&#x906D;&#x5230;SYN&#x653B;&#x51FB;&#x4E86;
netstat -nap | grep SYN_RECV
</code></pre>
<p><img src="../../assets/image-20220725202528340.png" alt="image-20220725202528340"></p>
<ul>
<li>&#x67E5;&#x770B;tcp&#x94FE;&#x63A5;&#x72B6;&#x6001;</li>
</ul>
<p>netstat -anoe|grep 8000|wc -l &#x67E5;&#x770B;8000</p>
<ul>
<li>&#x5229;&#x7528;&#x5982;&#x4E0B;&#x547D;&#x4EE4;&#x5224;&#x65AD;&#x5404;&#x4E2A;&#x72B6;&#x6001;&#x7684;&#x8FDE;&#x63A5;&#x6570;&#x662F;&#x5426;&#x6B63;&#x5E38;&#xFF1A;</li>
</ul>
<p>netstat -n | awk &apos;/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}&apos;</p>
<ul>
<li>TIME_WAIT &#x72B6;&#x6001;&#x6570;&#x91CF;&#x8FC7;&#x591A;&#xFF0C;&#x53EF;&#x5229;&#x7528;&#x5982;&#x4E0B;&#x547D;&#x4EE4;&#x67E5;&#x770B;&#x8FDE;&#x63A5;CLOSE_WAIT&#x6700;&#x591A;&#x7684;IP&#x5730;&#x5740;</li>
</ul>
<p>netstat -n|grep TIME_WAIT|awk &apos;{print $5}&apos;|awk -F: &apos;{print $1}&apos;|sort|uniq -c|sort -nr|head -10</p>
<h2 id="&#x5B9E;&#x4F8B;&#x5047;&#x6B7B;&#x5206;&#x6790;"><a name="&#x5B9E;&#x4F8B;&#x5047;&#x6B7B;&#x5206;&#x6790;" class="anchor-navigation-ex-anchor" href="#&#x5B9E;&#x4F8B;&#x5047;&#x6B7B;&#x5206;&#x6790;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.5. &#x5B9E;&#x4F8B;&#x5047;&#x6B7B;&#x5206;&#x6790;</h2>
<p>netstat -anop|grep &#x7AEF;&#x53E3;&#x53F7;</p>
<p>&#x65E5;&#x5FD7;&#x5173;&#x952E;&#x8BCD;&#xFF1A;OutOfMemoryError</p>
<pre><code class="lang-text">## 1&#x3001;&#x5185;&#x5B58;&#x5FEB;&#x7167;,pid&#x4E3A;&#x7EBF;&#x7A0B;id
jmap -dump:live,format=b,file=/tmp/jmap1.hporf PID
## 2&#x3001;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5FEB;&#x7167;
ps -ef|grep java|grep -v grep|awk &apos;{print $2}&apos;|xargs jmap -dump:live,format=b,file=api.bin
# 3&#x3001;&#x5185;&#x5B58;OOM&#x65F6;&#xFF0C;&#x81EA;&#x52A8;&#x751F;&#x6210;dump&#x6587;&#x4EF6;&#xFF0C;&#x542F;&#x52A8;&#x53C2;&#x6570;&#x914D;&#x7F6E; 
-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/data/logs/

## &#x538B;&#x7F29;&#x6587;&#x4EF6; &#x6587;&#x4EF6;&#x540D;&#x3001;&#x76EE;&#x6807;&#x6587;&#x4EF6;&#x8DEF;&#x5F84;
tar -czvf test1.tar.gz /tmp/test1.hporf
## &#x89E3;&#x538B;
tar -zxvf test1.tar.gz
</code></pre>
<p>1&#x3001;&#x662F;&#x5426;&#x6709;&#x5927;&#x6279;&#x91CF;&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;&#x5361;&#x5728;&#x540C;&#x4E00;&#x4E2A;&#x5730;&#x65B9;</p>
<p>&#x200B; java.lang.Thread.State: WAITING (parking)
&#x200B; at sun.misc.Unsafe.park(Native Method)</p>
<p>&#x200B; parking to wait for  <0x00000000e4e10670> (a java.util.concurrent.FutureTask)</0x00000000e4e10670></p>
<p>2&#x3001;&#x662F;&#x5426;&#x6709;&#x5168;&#x8868;&#x626B;&#x7801;&#x5BFC;&#x81F4;&#x67E5;&#x6240;&#x6709;&#x6570;&#x636E;</p>
<p>&#x200B; &#x9700;&#x8981;&#x8FD4;&#x56DE;&#x5168;&#x8868;&#x6570;&#x636E;&#x3002;&#x5927;&#x91CF;&#x7EBF;&#x7A0B;&#x8FC7;&#x6765;&#xFF0C;&#x5360;&#x7528;&#x5927;&#x91CF;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#xFF0C;&#x5BFC;&#x81F4;&#x6570;&#x636E;&#x5E93;&#x8FDE;&#x63A5;&#x6570;&#x4E0D;&#x591F;&#xFF1B;&#x800C;&#x6BCF;&#x4E2A;&#x7EBF;&#x7A0B;&#x5904;&#x7406;&#x65F6;&#xFF0C;&#x9700; &#x8981;&#x5927;&#x91CF;&#x65F6;&#x95F4;&#xFF0C; &#x5BFC;&#x81F4;&#x9879;&#x76EE;&#x5904;&#x4E8E;&#x4E00;&#x79CD;&#x5047;&#x6B7B;&#x7684;&#x72B6;&#x6001;&#x3002;</p>
<p>3&#x3001;&#x5806;&#x5916;&#x5BF9;&#x8C61;&#x592A;&#x591A;&#x9020;&#x6210;&#x673A;&#x5668;&#x5185;&#x5B58;&#x4E0D;&#x591F;</p>
<h2 id="&#x5185;&#x5B58;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF1A;"><a name="&#x5185;&#x5B58;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF1A;" class="anchor-navigation-ex-anchor" href="#&#x5185;&#x5B58;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF1A;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.6. &#x5185;&#x5B58;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF1A;</h2>
<p>Java&#x5806;&#x5206;&#x6790;&#x5668;&#xFF0C;&#x7528;&#x4E8E;&#x67E5;&#x627E;&#x5185;&#x5B58;&#x6CC4;&#x6F0F; Heap Dump&#xFF0C;&#x79F0;&#x4E3A;&#x5806;&#x8F6C;&#x50A8;&#x6587;&#x4EF6;&#xFF0C;&#x662F;Java&#x8FDB;&#x7A0B;&#x5728;&#x67D0;&#x4E2A;&#x65F6;&#x95F4;&#x5185;&#x7684;&#x5FEB;&#x7167;&#x3002; &#x5B83;&#x5728;&#x89E6;&#x53D1;&#x5FEB;&#x7167;&#x7684;&#x65F6;&#x5019;&#x4FDD;&#x5B58;&#x4E86;&#x5F88;&#x591A;&#x4FE1;&#x606F;&#xFF1A; Java&#x5BF9;&#x8C61;&#x548C;&#x7C7B;&#x4FE1;&#x606F;&#x3002;&#x901A;&#x5E38;&#x5728;&#x5199;Heap Dump&#x6587;&#x4EF6;&#x524D;&#x4F1A;&#x89E6;&#x53D1;&#x4E00;&#x6B21;Full GC&#x3002;</p>
<h3 id="mat"><a name="mat" class="anchor-navigation-ex-anchor" href="#mat"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.6.1. MAT</h3>
<p>MAT &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<a href="https://www.eclipse.org/mat/downloads.php" target="_blank">https://www.eclipse.org/mat/downloads.php</a></p>
<h3 id="ibm-heapanalyzer"><a name="ibm-heapanalyzer" class="anchor-navigation-ex-anchor" href="#ibm-heapanalyzer"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.6.2. ibm-heapanalyzer</h3>
<p>Download: <a href="https://www14.software.ibm.com/cgi-bin/weblap/lap.pl?popup=Y&amp;la_formnum=&amp;li_formnum=L-JHWG-85RF4Y&amp;accepted_url=https://public.dhe.ibm.com/software/websphere/appserv/support/tools/HeapAnalyzer/ha457.jar" target="_blank">https://www14.software.ibm.com/cgi-bin/weblap/lap.pl?popup=Y&amp;la_formnum=&amp;li_formnum=L-JHWG-85RF4Y&amp;accepted_url=https://public.dhe.ibm.com/software/websphere/appserv/support/tools/HeapAnalyzer/ha457.jar</a>
Open a terminal or command prompt and change directory to where you downloaded the JAR file. Ensure that Java is on your
PATH to run the tool. Launch the tool (increase -Xmx based on your available RAM):
java -Xmx2g -jar ha*.jar
<a href="https://www.ibm.com/support/pages/ibm-heapanalyzer" target="_blank">https://www.ibm.com/support/pages/ibm-heapanalyzer</a></p>
<h3 id="arthas"><a name="arthas" class="anchor-navigation-ex-anchor" href="#arthas"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.6.3. Arthas</h3>
<p><a href="https://gitee.com/arthas/arthas/" target="_blank">https://gitee.com/arthas/arthas/</a></p>
<p><a href="https://arthas.aliyun.com/doc/quick-start.html#_2-%E5%90%AF%E5%8A%A8-arthas" target="_blank">https://arthas.aliyun.com/doc/quick-start.html#_2-%E5%90%AF%E5%8A%A8-arthas</a></p>
<pre><code>##&#x4E0B;&#x8F7D;&#x6162;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x963F;&#x91CC;&#x4E91;&#xFF1A;
curl -O https://alibaba.github.io/arthas/arthas-boot.jar
curl -O https://arthas.aliyun.com/arthas-boot.jar
## &#x4F7F;&#x7528;&#x65B9;&#x5F0F;
java -jar arthas-boot.jar
or
java -jar arthas-boot.jar -h ##&#x67E5;&#x770B;&#x5E2E;&#x52A9;&#x4FE1;&#x606F;
## &#x5B9E;&#x65F6;&#x9762;&#x677F; dashboard &#x9ED8;&#x8BA4;&#x5237;&#x65B0;&#x95F4;&#x9694;5m
dashboard
# &#x67E5;&#x770B;cpu&#x9AD8;&#x7684;&#x7EBF;&#x7A0B;&#xFF0C;&#x7EBF;&#x7A0B;&#x76D1;&#x63A7; -n &#x6700;&#x5FD9;&#x591A;&#x5C11;&#x4E2A;  -i &#x6307;&#x5B9A;&#x9891;&#x7387;&#x5355;&#x4F4D;&#x6BEB;&#x79D2;
## --state WAITING  &#x6307;&#x5B9A;&#x72B6;&#x6001;
thread -n 3 -i 200
## &#x67E5;&#x8BE2;&#x963B;&#x585E;&#x7EBF;&#x7A0B;
thread -b 
## &#x6307;&#x5B9A;&#x7EBF;&#x7A0B;&#x72B6;&#x6001;
thread --state

## &#x751F;&#x6210;&#x5806;&#x5FEB;&#x7167;
heapdump
## &#x67E5;&#x770B;JVM&#x7684;&#x73AF;&#x5883;&#x53D8;&#x91CF;
sysenv
## &#x67E5;&#x770B;&#x65E5;&#x5FD7;&#x7EA7;&#x522B;
logger
## &#x6307;&#x5B9A;logger&#x7EA7;&#x522B;
logger --name com.xyy.tuangou.web.api.user.service.impl.YkqAgentServiceImpl --level info
## jvm
COUNT: JVM &#x5F53;&#x524D;&#x6D3B;&#x8DC3;&#x7684;&#x7EBF;&#x7A0B;&#x6570;
DAEMON-COUNT: JVM &#x5F53;&#x524D;&#x6D3B;&#x8DC3;&#x7684;&#x5B88;&#x62A4;&#x7EBF;&#x7A0B;&#x6570;
PEAK-COUNT: &#x4ECE; JVM &#x542F;&#x52A8;&#x5F00;&#x59CB;&#x66FE;&#x7ECF;&#x6D3B;&#x7740;&#x7684;&#x6700;&#x5927;&#x7EBF;&#x7A0B;&#x6570;
STARTED-COUNT: &#x4ECE; JVM &#x542F;&#x52A8;&#x5F00;&#x59CB;&#x603B;&#x5171;&#x542F;&#x52A8;&#x8FC7;&#x7684;&#x7EBF;&#x7A0B;&#x6B21;&#x6570;
DEADLOCK-COUNT: JVM &#x5F53;&#x524D;&#x6B7B;&#x9501;&#x7684;&#x7EBF;&#x7A0B;&#x6570;
MAX-FILE-DESCRIPTOR-COUNT&#xFF1A;JVM &#x8FDB;&#x7A0B;&#x6700;&#x5927;&#x53EF;&#x4EE5;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6570;
OPEN-FILE-DESCRIPTOR-COUNT&#xFF1A;JVM &#x5F53;&#x524D;&#x6253;&#x5F00;&#x7684;&#x6587;&#x4EF6;&#x63CF;&#x8FF0;&#x7B26;&#x6570;

## &#x4F7F;&#x7528;&amp;&#x5728;&#x540E;&#x53F0;&#x6267;&#x884C;&#x4EFB;&#x52A1;
## &#x67E5;&#x770B;&#x52A0;&#x8F7D;&#x7C7B;&#x7684;&#x6570;&#x91CF;&#xFF0C;JVM class count  &#x7C7B;&#x592A;&#x591A;&#x52A8;&#x6001;&#x4EE3;&#x7406;-&#x4E00;&#x822C;&#x662F;2-3w 
classloader
## jad &#x7F16;&#x8BD1;&#x6E90;&#x7801;  --source-only&#x53EA;&#x663E;&#x793A;&#x6E90;&#x7801;  --lineNumber false &#x4E0D;&#x663E;&#x793A;&#x884C;&#x53F7;
jad --source-only demo.MathGame

## &#x5177;&#x4F53;&#x547D;&#x4EE4;&#x5217;&#x8868;
https://arthas.aliyun.com/doc/commands.html
</code></pre><pre><code>
thread &#x5B57;&#x6BB5;&#x4ECB;&#x7ECD;&#xFF1A;

&#x6CA1;&#x6709;&#x7EBF;&#x7A0B; ID&#xFF0C;&#x5305;&#x542B;[Internal]&#x8868;&#x793A;&#x4E3A; JVM &#x5185;&#x90E8;&#x7EBF;&#x7A0B;&#xFF0C;&#x53C2;&#x8003;dashboard&#x547D;&#x4EE4;&#x7684;&#x4ECB;&#x7ECD;&#x3002;
cpuUsage&#x4E3A;&#x91C7;&#x6837;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#x5185;&#x7EBF;&#x7A0B;&#x7684; CPU &#x4F7F;&#x7528;&#x7387;&#xFF0C;&#x4E0E;dashboard&#x547D;&#x4EE4;&#x7684;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x3002;
deltaTime&#x4E3A;&#x91C7;&#x6837;&#x95F4;&#x9694;&#x65F6;&#x95F4;&#x5185;&#x7EBF;&#x7A0B;&#x7684;&#x589E;&#x91CF; CPU &#x65F6;&#x95F4;&#xFF0C;&#x5C0F;&#x4E8E; 1ms &#x65F6;&#x88AB;&#x53D6;&#x6574;&#x663E;&#x793A;&#x4E3A; 0ms&#x3002;
time &#x7EBF;&#x7A0B;&#x8FD0;&#x884C;&#x603B; CPU &#x65F6;&#x95F4;&#x3002;


logger --name com.xyy.tuangou.web.api.user.service.impl.YkqAgentServiceImpl --level info
</code></pre><h2 id="&#x5728;&#x7EBF;&#x5206;&#x6790;"><a name="&#x5728;&#x7EBF;&#x5206;&#x6790;" class="anchor-navigation-ex-anchor" href="#&#x5728;&#x7EBF;&#x5206;&#x6790;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.7. &#x5728;&#x7EBF;&#x5206;&#x6790;</h2>
<h3 id="gc&#x65E5;&#x5FD7;"><a name="gc&#x65E5;&#x5FD7;" class="anchor-navigation-ex-anchor" href="#gc&#x65E5;&#x5FD7;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.7.1. gc&#x65E5;&#x5FD7;</h3>
<p><a href="https://gceasy.io/diamondgc-report.jsp?oTxnId_value=6a0ffee4-3b8a-4ac5-ae46-102699c0fede" target="_blank">https://gceasy.io/diamondgc-report.jsp?oTxnId_value=6a0ffee4-3b8a-4ac5-ae46-102699c0fede</a></p>
<h3 id="&#x5806;&#x5FEB;&#x7167;&#x5206;&#x6790;"><a name="&#x5806;&#x5FEB;&#x7167;&#x5206;&#x6790;" class="anchor-navigation-ex-anchor" href="#&#x5806;&#x5FEB;&#x7167;&#x5206;&#x6790;"><i class="fa fa-link" aria-hidden="true"></i></a>1.6.2.2.7.2. &#x5806;&#x5FEB;&#x7167;&#x5206;&#x6790;</h3>
<p><a href="https://heaphero.io/" target="_blank">https://heaphero.io/</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../jvm/jvm.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: 内存优化汇总篇">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"线上排查","level":"1.6.2","depth":2,"next":{"title":"spring","level":"1.7","depth":1,"ref":"","articles":[{"title":"spring-security","level":"1.7.1","depth":2,"path":"md/spring/spring-security.md","ref":"md/spring/spring-security.md","articles":[]}]},"previous":{"title":"内存优化汇总篇","level":"1.6.1","depth":2,"path":"md/jvm/jvm.md","ref":"md/jvm/jvm.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","github","-sharing","search-pro","-search","-lunr","page-treeview","anchor-navigation-ex"],"styles":{"website":"styles/website.css"},"pluginsConfig":{"page-treeview":{"collapsed":false,"copyright":"","minHeaderCount":"2","minHeaderDeep":"2"},"github":{"url":""},"search-pro":{},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"","level2Icon":"","level3Icon":"","showLevelIcon":false},"printLog":false,"showGoTop":true,"showLevel":true},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true},"expandable-chapters":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"zh-hans","gitbook":"*"},"file":{"path":"md/optimization/线上排查汇总.md","mtime":"2023-10-20T09:10:53.197Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-10-20T09:26:54.071Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

